<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">

  <!-- PACE Progress Bar START -->
  
    <script src="https://raw.githubusercontent.com/HubSpot/pace/v1.0.2/pace.min.js"></script>
    <link rel="stylesheet" href="https://github.com/HubSpot/pace/raw/master/themes/orange/pace-theme-flash.css">
  
  

  <!-- PACE Progress Bar START -->

  
  <title> azure app service linux - adding php extensions		 | Azure OSS Developer Support</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta name="description" content="Customers that need to install PHP extensions that are not available on the provided PHP images on Azure App Services Linux can perform the following steps below to install their extensions. Install P">
<meta property="og:type" content="article">
<meta property="og:title" content=" Azure App Service Linux - Adding PHP Extensions		">
<meta property="og:url" content="http://azureossd.github.io/azure-app-service-linux-adding-php-extensions/index.html">
<meta property="og:site_name" content="Azure OSS Developer Support">
<meta property="og:description" content="Customers that need to install PHP extensions that are not available on the provided PHP images on Azure App Services Linux can perform the following steps below to install their extensions. Install P">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-03-27T01:01:24.168Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" Azure App Service Linux - Adding PHP Extensions		">
<meta name="twitter:description" content="Customers that need to install PHP extensions that are not available on the provided PHP images on Azure App Services Linux can perform the following steps below to install their extensions. Install P">
  
    <link rel="alternate" href="/atom.xml" title="Azure OSS Developer Support" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="https://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/hiero.css">
  <link rel="stylesheet" href="/css/glyphs.css">
  

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/css/my.css">
  <!-- Google Adsense -->
  
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-0123456789ABCDEFFFFFF",
          enable_page_level_ads: true
      });
  </script>
  
</head>
</html>
<script>
var themeMenus = {};

  themeMenus["/"] = "Home"; 

  themeMenus["/archives"] = "Archives"; 

</script>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  <header id="allheader" class="site-header" role="banner">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="Azure OSS Developer Support" rel="home"> Azure OSS Developer Support </a>
            
          </h1>

          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>
            <div class="clearfix sf-menu">

              <ul id="main-nav" class="nmenu sf-js-enabled">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/archives">Archives</a> </li>
                    
              </ul>
            </div>
          </nav>


      </div>
  </div>
</header>


  <div id="originBgDiv" style="background: #fff; width: 100%;">

      <div style="max-height:600px; overflow: hidden;  display: flex; display: -webkit-flex; align-items: center;">
        <img id="originBg" width="100%" alt src>
      </div>

  </div>

  <script>
  function setAboutIMG(){
      var imgUrls = "css/images/pose.jpg,https://source.unsplash.com/collection/954550/1920x1080".split(",");
      var random = Math.floor((Math.random() * imgUrls.length ));
      if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
        document.getElementById("originBg").src=imgUrls[random];
      } else {
        document.getElementById("originBg").src='/' + imgUrls[random];
      }
  }
  bgDiv=document.getElementById("originBgDiv");
  if(location.pathname.match('about')){
    setAboutIMG();
    bgDiv.style.display='block';
  }else{
    bgDiv.style.display='none';
  }
  </script>



  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-azure-app-service-linux-adding-php-extensions" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
       Azure App Service Linux - Adding PHP Extensions		
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	Posted on <a href="/azure-app-service-linux-adding-php-extensions/" class="article-date">
	  <time datetime="2019-01-29T20:14:34.000Z" itemprop="datePublished">January 29, 2019</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Customers that need to install PHP extensions that are not available on the provided PHP images on Azure App Services Linux can perform the following steps below to install their extensions.</p>
<h4 id="Install-PHP-extensions"><a href="#Install-PHP-extensions" class="headerlink" title="Install PHP extensions-"></a>Install PHP extensions-</h4><ol>
<li>Go to your KUDU console https://\&lt;sitename>.scm.azurewebsites.net</li>
<li>Select SSH.</li>
<li><p>In your SSH session, run the command highlighted in yellow.</p>
<pre><code>root@3628690f5888:/home/site/wwwroot# pear config-show
Configuration (channel pear.php.net):
=====================================
Auto-discover new Channels     auto_discover    &lt;not set&gt;
Default Channel                default_channel  pear.php.net
HTTP Proxy Server Address      http_proxy       &lt;not set&gt;
PEAR server [DEPRECATED]       master_server    pear.php.net
Default Channel Mirror         preferred_mirror pear.php.net
Remote Configuration File      remote_config    &lt;not set&gt;
PEAR executables directory     bin_dir          /usr/local/bin
PEAR documentation directory   doc_dir          /usr/local/lib/php/doc
PHP extension directory        ext_dir          /usr/local/lib/php/extensions/no-debug-non-zts-20151012
PEAR directory                 php_dir          /usr/local/lib/php
PEAR Installer cache directory cache_dir        /tmp/pear/cache
PEAR configuration file        cfg_dir          /usr/local/lib/php/cfg
</code></pre><a id="more"></a></li>
<li><p>In the output above, the path for ext_dir is where your extension will be downloaded.  Note the path for later use.</p>
</li>
<li><p>To install an extension, perform the following.  I’ll be installing the PHP extension “redis” in this example.</p>
<pre><code>root@3628690f5888:/home/site/wwwroot# pecl install redis
downloading redis-4.1.1.tgz ...
Starting to download redis-4.1.1.tgz (220,894 bytes)
..............................................done: 220,894 bytes
25 source files, building
running: phpize
Configuring for:
PHP Api Version:         20151012
Zend Module Api No:      20151012
Zend Extension Api No:   320151012
enable igbinary serializer support? [no] :
enable lzf compression support? [no] :
……
Build process completed successfully
Installing &apos;/usr/local/lib/php/extensions/no-debug-non-zts-20151012/redis.so&apos;
install ok: channel://pecl.php.net/redis-4.1.1
configuration option &quot;php_ini&quot; is not set to php.ini location
You should add &quot;extension=redis.so&quot; to php.ini
</code></pre></li>
</ol>
<p>6. You’ll notice the path to the newly installed extension (highlighted in green) is also returned after it’s installed and matches the “ext_dir” path returned from the Pear configurations.</p>
<ol start="7">
<li><p>Now that the extension is installed, we’ll need to create an “ext” directory under “/home/site” and copy the extension to that directory so that the extension persists if the container is restarted.  Below are the commands to do this.</p>
<p> root@9a793907fbb0:/home/site/wwwroot# mkdir /home/site/ext<br> root@9a793907fbb0:/home/site/wwwroot# cp /home/site/ext/usr/local/lib/php/extensions/no-debug-non-zts-20151012/redis.so /home/site/ext</p>
<p>Note:  The text may continue and look *garbled.  Don’t worry, keep entering the command.</p>
</li>
<li><p>The command highlighted in yellow creates the “ext” directory and the one in green copies the files from the installation location to the new directory.</p>
</li>
<li><p>Once this is done, perform the steps provided at <a href="https://blogs.msdn.microsoft.com/azureossds/2019/01/29/azure-app-service-linux-update-php-settings/" target="_blank" rel="noopener">App Service Linux - Update PHP Settings</a>.</p>
</li>
</ol>
<h4 id="Recompiling-PHP-extensions"><a href="#Recompiling-PHP-extensions" class="headerlink" title="Recompiling PHP extensions -"></a>Recompiling PHP extensions -</h4><p>If you need to reconfigure an extension such as GD, please use the following steps.</p>
<ol>
<li>SSH into your container and run the following</li>
<li>“docker-php-ext-configure gd –with-freetype-dir=/usr –with-jpeg-dir=/usr”</li>
<li>“docker-php-ext-install gd”</li>
<li>cp /usr/local/lib/php/extensions/no-debug-non-zts-20151012/gd.so /home/site/ext</li>
</ol>
<p>To test, run “service apache2 reload” then go your PHP info page to see if the “freetype” is listed under GD.  If so, update the “extensions.ini” as shown in the “Adding the Extension” section.  We will need to make some further modifications to avoid a conflict with the GD extension if the site were to be rebooted.  In your Application Settings, add the following so that the “extensions.ini” is loaded before the ones under “/usr/local/etc/php/conf.d”</p>
<p>Additionally, you can perform the additional steps to move the other INI files to the “/home/site/ini” directory.  In step 3, we’ll rename the INI for GD so that it doesn’t load the original GD extension on startup but continues to load other extensions.</p>
<ol>
<li>cp /usr/local/etc/php/conf.d/* /home/site/ini</li>
<li>cd /home/site/ini</li>
<li>mv docker-php-ext-gd.ini docker-php-ext-gd.old</li>
</ol>
<h4 id="Adding-the-Extension"><a href="#Adding-the-Extension" class="headerlink" title="Adding the Extension-"></a>Adding the Extension-</h4><p>Once the steps performed at <a href="https://blogs.msdn.microsoft.com/azureossds/2019/01/29/azure-app-service-linux-update-php-settings/" target="_blank" rel="noopener">App Service Linux - Updating PHP settings</a> are complete, you’ll have an “extensions.ini” in your “/home/site/ini” directory.  Below are some options for modifying the extensions.ini file to include our new PHP extension.</p>
<h5 id="Option-1-Echo"><a href="#Option-1-Echo" class="headerlink" title="Option #1 - Echo"></a>Option #1 - Echo</h5><ol>
<li>Change directories to /home/site/ini.</li>
<li><p>Type the following.</p>
<p>  echo “extensions=/home/site/ext/redis.so” &gt;&gt; extensions.ini</p>
</li>
</ol>
<h5 id="Option-2-Vi"><a href="#Option-2-Vi" class="headerlink" title="Option #2 - Vi"></a>Option #2 - Vi</h5><ol>
<li>Change directories to /home/site/ini.</li>
<li>Perform the following</li>
</ol>
<p>a) vi extensions.ini\<br>b) Press “i” on your keyboard to start editing and add the following.</p>
<pre><code>extension=/home/site/ext/redis.so
</code></pre><p>c) Press “Esc”, then “:wq!” and enter to save.</p>
<p>Once you’re done, restart the site using the Azure Portal and you’ll now see the extension installed in your PHPInfo page.</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/Azure-App-Service-Web-App/">Azure App Service Web App</a>

      
      
            
      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>


      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/how-to-send-emails-through-azure-web-apps-using-google-gmail/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
           How to send emails through Azure Web Apps using Google / Gmail		
        
      </div>
    </a>
  
  
    <a href="/azure-app-service-linux-update-php-settings/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"> Azure App Service Linux - Update PHP Settings		</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article" style="overflow-y: scroll; max-width: 28%;">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Install-PHP-extensions"><span class="nav-number">1.</span> <span class="nav-text">Install PHP extensions-</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Recompiling-PHP-extensions"><span class="nav-number">2.</span> <span class="nav-text">Recompiling PHP extensions -</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Adding-the-Extension"><span class="nav-number">3.</span> <span class="nav-text">Adding the Extension-</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Option-1-Echo"><span class="nav-number">3.1.</span> <span class="nav-text">Option #1 - Echo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Option-2-Vi"><span class="nav-number">3.2.</span> <span class="nav-text">Option #2 - Vi</span></a></li></ol></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>
      <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 Azure OSS Developer Support All Rights Reserved.
          
      </div>
      <div class="site-credit">
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var contentdiv = document.getElementById("content");

    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
</script>

<!-- Custome JS -->
<script src="/js/my.js"></script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>


<script src="/js/scripts.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>








  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
